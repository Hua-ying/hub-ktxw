# GPT4Rec的具体实现
## 1.方法实现
### 1.用大模型生成查询
  从用户的历史交互序列中获取[item1,item2,item3,item4,....],其中每个item是物品名称；然后通过构造提示词模板 **Previously, the customer has bought:<ITEM TITLE 1>. <ITEM TITLE 2>... In the future, the customer wants to buy**并微调对应的数据集，从大模型通过beam search给出多个可能的Query

### 2.通过BM25算法进行检索
  用大模型生成的多个Query作为输入去物品库中采用BM25算法进行检索。具体实现过程：如果有K个需要推荐的物品和m个生成的Query。对得分最高的Query先检索K/m个物品，然后将剩下的Query按照得分顺序分别去检索K/m个之前没有检索到的物品
  
## 2.训练过程
  在两个公开数据集上进行了训练，将数据集按照 **8:1:1** 划分成了训练集，测试集和验证集。
### 1.微调大模型
  通过用户历史交互记录的前 **T-1** 项物品构造提示词模板，然后再将其与用户的最后一个物品名称拼接构成一条训练文本，然后用多条训练文本构成的训练语料库对大模型进行微调，使模型学会在给定历史交互序列时时生成可能的物品名称。
### 2.优化BM25参数
  通过网格搜索的方法对BM25算法的**k1**和**b**进行优化，使最后的评价指标**Recall@K（召回率）**,**Diversity@K（推荐列表商品多样性）**和**Coverage@K（推荐列表商品占用户总商品的比例）** 最高
